<!-- Parcel Editing Page Developed by Me -->
{% extends "base.html" %}

{% block content %}
<div class="glass-panel">
    <h2>✏️ Edit Parcel: {{ parcel.id }}</h2>

    <div class="split-view">
        <div class="edit-form-section">
            <form action="/edit_parcel/{{ parcel.id }}" method="POST">
                <!-- Parcel Details Update -->
                <h3>Details</h3>
                <div class="form-group">
                    <label>Current Status</label>
                    <select name="status">
                        <option value="Pending Pickup" {% if parcel.status=='Pending Pickup' %}selected{% endif %}>
                            Pending Pickup</option>
                        <option value="In Transit" {% if parcel.status=='In Transit' %}selected{% endif %}>In Transit
                        </option>
                        <option value="Out for Delivery" {% if parcel.status=='Out for Delivery' %}selected{% endif %}>
                            Out for Delivery</option>
                        <option value="Delivered" {% if parcel.status=='Delivered' %}selected{% endif %}>Delivered
                        </option>
                        <option value="On Hold" {% if parcel.status=='On Hold' %}selected{% endif %}>On Hold</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Start Address</label>
                    <input type="text" name="start_address" value="{{ parcel.start_address }}">
                </div>

                <div class="form-group">
                    <label>End Address</label>
                    <input type="text" name="end_address" value="{{ parcel.end_address }}">
                </div>

                <div class="form-group">
                    <label>Live Location</label>
                    <input type="text" name="current_location" value="{{ parcel.current_location }}">
                </div>

                <!-- History Update Section -->
                <h3>Update Tracking</h3>
                <div class="form-group">
                    <label>New Status Header</label>
                    <input type="text" name="new_status_header" placeholder="e.g. Shipped / Out for Delivery">
                </div>

                <div class="form-group">
                    <label>Description</label>
                    <input type="text" name="new_description" placeholder="e.g. Your item has been shipped.">
                </div>

                <div class="form-group">
                    <label>Subtext</label>
                    <input type="text" name="new_subtext" placeholder="e.g. Courier Partner Info">
                </div>

                <div class="form-group">
                    <label>Location</label>
                    <input type="text" name="new_location" placeholder="Leave empty to use current location">
                </div>

                <div class="split-view" style="gap: 10px; margin-bottom: 0;">
                    <div class="form-group">
                        <label>Date (YYYY-MM-DD)</label>
                        <input type="date" name="new_date">
                    </div>
                    <div class="form-group">
                        <label>Time (HH:MM)</label>
                        <input type="time" name="new_time">
                    </div>
                </div>

                <button type="submit" class="animated-button">Save Changes</button>
            </form>
        </div>

        <!-- Preview Section -->
        <div class="preview-section">
            {% if parcel.image %}
            <h3>Parcel Image</h3>
            <img src="{{ url_for('static', filename=parcel.image) }}" alt="Parcel Image" class="parcel-preview-img">
            {% endif %}

            <h3>History</h3>
            <ul class="history-list-mini">
                {% for event in parcel.tracking_history %}
                <li>
                    <span class="time">{{ event.timestamp }}</span>
                    <span class="loc">{{ event.location }}</span>
                    <span class="stat">{{ event.status }}</span>
                    {% if event.description %}<br><small><i>{{ event.description }}</i></small>{% endif %}
                    {% if event.subtext %}<br><small><b>{{ event.subtext }}</b></small>{% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock %}